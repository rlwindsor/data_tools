Tracking specific tags
================
Young Ha Suh
10/19/2020

### Load libraries

``` r
library(tidyverse)
library(knitr)
library(lubridate)
```

<br>

### Load data

Load tag data and set variables

``` r
oct19 <- read.csv("../data_tools/datafiles/station_beep_merged_oct19.csv" )
oct19$time <- as.POSIXct(oct19$Time ,format="%m/%d/%Y %H:%M", tz = "UTC")
oct19$time_est <- with_tz(oct19$time, "EST") #change from UTC to EST

# Filter to time points after Oct 17, which is the start of data I downloaded
oct <- oct19 %>% 
  filter(time_est > '2020-10-17 00:00:00')
```

Load node info

``` r
nodes <- read.csv("nodes.csv")
```

<br>

### Data wrangling

Use tidyverse to manipulate data.

``` r
# Need to convert to upper case to left join with the node data
oct$NodeId <- toupper(oct$NodeId)
#table(oct$NodeId) # check if it worked

# Add node numerical ID
oct <- oct %>% 
  left_join(nodes, by = "NodeId")
```

<br>

### Look for rows containing specific tag IDs

Change accordingly

``` r
# Check list of tags detected
# table(oct$TagId)

# set tags
tag1 <- "61342D4C" # -QGA
tag2 <- "342A3478" # -BBX
```

Look for these specific ones

  - Tag 1

<!-- end list -->

``` r
tag1data <- oct %>% 
  filter(TagId == tag1) %>% 
  group_by(NodeId) %>% 
  mutate(timeofday = strftime(time_est, format="%H:%M:%S")) %>% 
  arrange(NodeId, -TagRSSI, timeofday) %>% 
  #filter(TagRSSI > -110) %>%    set if there are too many rows
  select(NodeId, id, TagRSSI, time_est, timeofday)

oct %>% 
  filter(TagId == tag1) %>% 
  group_by(NodeId) %>% 
  mutate(timeofday = strftime(time_est, format="%H:%M:%S")) %>% 
  arrange(NodeId, -TagRSSI, timeofday) %>% 
  select(NodeId, id, TagRSSI, time_est, timeofday) %>% 
  kable()
```

| NodeId | id | TagRSSI | time\_est           | timeofday |
| :----- | -: | ------: | :------------------ | :-------- |
| 425    | 17 |   \-114 | 2020-10-17 09:47:00 | 10:47:00  |
| 425    | 17 |   \-114 | 2020-10-17 09:47:00 | 10:47:00  |
| 425    | 17 |   \-114 | 2020-10-17 09:47:00 | 10:47:00  |
| 425    | 17 |   \-114 | 2020-10-17 09:47:00 | 10:47:00  |
| 425    | 17 |   \-114 | 2020-10-17 10:03:00 | 11:03:00  |
| 425    | 17 |   \-114 | 2020-10-17 10:03:00 | 11:03:00  |
| 425    | 17 |   \-115 | 2020-10-17 10:11:00 | 11:11:00  |
| 425    | 17 |   \-115 | 2020-10-17 10:11:00 | 11:11:00  |
| 425    | 17 |   \-115 | 2020-10-17 10:35:00 | 11:35:00  |
| 425    | 17 |   \-115 | 2020-10-17 11:05:00 | 12:05:00  |
| 425    | 17 |   \-115 | 2020-10-17 13:56:00 | 14:56:00  |
| 425    | 17 |   \-117 | 2020-10-17 10:23:00 | 11:23:00  |
| 425    | 17 |   \-117 | 2020-10-17 10:23:00 | 11:23:00  |
| C3     | 10 |   \-105 | 2020-10-17 09:36:00 | 10:36:00  |
| C3     | 10 |   \-105 | 2020-10-17 09:36:00 | 10:36:00  |
| C3     | 10 |   \-105 | 2020-10-17 10:20:00 | 11:20:00  |
| C3     | 10 |   \-105 | 2020-10-17 10:20:00 | 11:20:00  |
| C3     | 10 |   \-105 | 2020-10-17 10:33:00 | 11:33:00  |
| C3     | 10 |   \-105 | 2020-10-17 10:33:00 | 11:33:00  |
| C3     | 10 |   \-105 | 2020-10-17 11:05:00 | 12:05:00  |
| C3     | 10 |   \-105 | 2020-10-17 11:05:00 | 12:05:00  |
| C3     | 10 |   \-105 | 2020-10-17 11:24:00 | 12:24:00  |
| C3     | 10 |   \-105 | 2020-10-17 11:50:00 | 12:50:00  |
| C3     | 10 |   \-106 | 2020-10-17 09:37:00 | 10:37:00  |
| C3     | 10 |   \-106 | 2020-10-17 09:37:00 | 10:37:00  |
| C3     | 10 |   \-106 | 2020-10-17 09:39:00 | 10:39:00  |
| C3     | 10 |   \-106 | 2020-10-17 09:46:00 | 10:46:00  |
| C3     | 10 |   \-106 | 2020-10-17 10:01:00 | 11:01:00  |
| C3     | 10 |   \-106 | 2020-10-17 10:01:00 | 11:01:00  |
| C3     | 10 |   \-106 | 2020-10-17 10:12:00 | 11:12:00  |
| C3     | 10 |   \-106 | 2020-10-17 10:12:00 | 11:12:00  |
| C3     | 10 |   \-106 | 2020-10-17 10:20:00 | 11:20:00  |
| C3     | 10 |   \-106 | 2020-10-17 10:20:00 | 11:20:00  |
| C3     | 10 |   \-106 | 2020-10-17 10:24:00 | 11:24:00  |
| C3     | 10 |   \-106 | 2020-10-17 10:42:00 | 11:42:00  |
| C3     | 10 |   \-106 | 2020-10-17 11:04:00 | 12:04:00  |
| C3     | 10 |   \-106 | 2020-10-17 11:04:00 | 12:04:00  |
| C3     | 10 |   \-106 | 2020-10-17 11:25:00 | 12:25:00  |
| C3     | 10 |   \-106 | 2020-10-17 11:25:00 | 12:25:00  |
| C3     | 10 |   \-106 | 2020-10-17 11:26:00 | 12:26:00  |
| C3     | 10 |   \-106 | 2020-10-17 11:26:00 | 12:26:00  |
| C3     | 10 |   \-106 | 2020-10-17 12:45:00 | 13:45:00  |
| C3     | 10 |   \-106 | 2020-10-17 13:12:00 | 14:12:00  |
| C3     | 10 |   \-106 | 2020-10-17 13:12:00 | 14:12:00  |
| C3     | 10 |   \-107 | 2020-10-17 09:42:00 | 10:42:00  |
| C3     | 10 |   \-107 | 2020-10-17 09:50:00 | 10:50:00  |
| C3     | 10 |   \-107 | 2020-10-17 09:50:00 | 10:50:00  |
| C3     | 10 |   \-107 | 2020-10-17 09:54:00 | 10:54:00  |
| C3     | 10 |   \-107 | 2020-10-17 09:54:00 | 10:54:00  |
| C3     | 10 |   \-107 | 2020-10-17 10:07:00 | 11:07:00  |
| C3     | 10 |   \-107 | 2020-10-17 10:07:00 | 11:07:00  |
| C3     | 10 |   \-107 | 2020-10-17 10:17:00 | 11:17:00  |
| C3     | 10 |   \-107 | 2020-10-17 10:21:00 | 11:21:00  |
| C3     | 10 |   \-107 | 2020-10-17 10:21:00 | 11:21:00  |
| C3     | 10 |   \-107 | 2020-10-17 10:38:00 | 11:38:00  |
| C3     | 10 |   \-107 | 2020-10-17 10:39:00 | 11:39:00  |
| C3     | 10 |   \-107 | 2020-10-17 10:44:00 | 11:44:00  |
| C3     | 10 |   \-107 | 2020-10-17 10:44:00 | 11:44:00  |
| C3     | 10 |   \-107 | 2020-10-17 10:45:00 | 11:45:00  |
| C3     | 10 |   \-107 | 2020-10-17 10:45:00 | 11:45:00  |
| C3     | 10 |   \-107 | 2020-10-17 11:02:00 | 12:02:00  |
| C3     | 10 |   \-107 | 2020-10-17 11:02:00 | 12:02:00  |
| C3     | 10 |   \-107 | 2020-10-17 11:37:00 | 12:37:00  |
| C3     | 10 |   \-107 | 2020-10-17 12:44:00 | 13:44:00  |
| C3     | 10 |   \-108 | 2020-10-17 09:52:00 | 10:52:00  |
| C3     | 10 |   \-108 | 2020-10-17 09:52:00 | 10:52:00  |
| C3     | 10 |   \-108 | 2020-10-17 10:04:00 | 11:04:00  |
| C3     | 10 |   \-108 | 2020-10-17 10:31:00 | 11:31:00  |
| C3     | 10 |   \-108 | 2020-10-17 10:31:00 | 11:31:00  |
| C3     | 10 |   \-108 | 2020-10-17 10:35:00 | 11:35:00  |
| C3     | 10 |   \-108 | 2020-10-17 10:37:00 | 11:37:00  |
| C3     | 10 |   \-108 | 2020-10-17 10:37:00 | 11:37:00  |
| C3     | 10 |   \-108 | 2020-10-17 11:00:00 | 12:00:00  |
| C3     | 10 |   \-108 | 2020-10-17 13:11:00 | 14:11:00  |
| C3     | 10 |   \-109 | 2020-10-17 09:47:00 | 10:47:00  |
| C3     | 10 |   \-109 | 2020-10-17 09:50:00 | 10:50:00  |
| C3     | 10 |   \-109 | 2020-10-17 09:50:00 | 10:50:00  |
| C3     | 10 |   \-109 | 2020-10-17 09:55:00 | 10:55:00  |
| C3     | 10 |   \-109 | 2020-10-17 10:01:00 | 11:01:00  |
| C3     | 10 |   \-109 | 2020-10-17 10:01:00 | 11:01:00  |
| C3     | 10 |   \-109 | 2020-10-17 10:15:00 | 11:15:00  |
| C3     | 10 |   \-109 | 2020-10-17 10:23:00 | 11:23:00  |
| C3     | 10 |   \-109 | 2020-10-17 10:23:00 | 11:23:00  |
| C3     | 10 |   \-109 | 2020-10-17 10:26:00 | 11:26:00  |
| C3     | 10 |   \-109 | 2020-10-17 10:26:00 | 11:26:00  |
| C3     | 10 |   \-109 | 2020-10-17 11:03:00 | 12:03:00  |
| C3     | 10 |   \-110 | 2020-10-17 10:09:00 | 11:09:00  |
| C3     | 10 |   \-110 | 2020-10-17 10:23:00 | 11:23:00  |
| C3     | 10 |   \-110 | 2020-10-17 10:23:00 | 11:23:00  |
| C3     | 10 |   \-110 | 2020-10-17 10:30:00 | 11:30:00  |
| C3     | 10 |   \-110 | 2020-10-17 10:30:00 | 11:30:00  |
| C3     | 10 |   \-110 | 2020-10-17 10:57:00 | 11:57:00  |
| C3     | 10 |   \-110 | 2020-10-17 11:36:00 | 12:36:00  |
| C3     | 10 |   \-111 | 2020-10-17 10:03:00 | 11:03:00  |
| C3     | 10 |   \-111 | 2020-10-17 10:03:00 | 11:03:00  |
| C3     | 10 |   \-111 | 2020-10-17 10:03:00 | 11:03:00  |
| C3     | 10 |   \-111 | 2020-10-17 10:03:00 | 11:03:00  |
| C3     | 10 |   \-111 | 2020-10-17 10:10:00 | 11:10:00  |
| C3     | 10 |   \-111 | 2020-10-17 10:10:00 | 11:10:00  |
| C3     | 10 |   \-113 | 2020-10-17 11:03:00 | 12:03:00  |
| C3     | 10 |   \-113 | 2020-10-17 11:03:00 | 12:03:00  |
| C3     | 10 |   \-114 | 2020-10-17 10:16:00 | 11:16:00  |
| C3     | 10 |   \-114 | 2020-10-17 10:42:00 | 11:42:00  |
| C3     | 10 |   \-114 | 2020-10-17 10:42:00 | 11:42:00  |

``` r
View(tag1data)
```

<br>

  - Tag 2

<!-- end list -->

``` r
tag2data <- oct %>% 
  filter(TagId == tag2) %>% 
  group_by(NodeId) %>% 
  mutate(timeofday = strftime(time_est, format="%H:%M:%S")) %>% 
  arrange(NodeId, -TagRSSI, timeofday) %>% 
  select(NodeId, id, TagRSSI, time_est, timeofday)

oct %>% 
  filter(TagId == tag2) %>% 
  group_by(NodeId) %>% 
  mutate(timeofday = strftime(time_est, format="%H:%M:%S")) %>% 
  arrange(NodeId, -TagRSSI, timeofday) %>% 
  select(NodeId, id, TagRSSI, time_est, timeofday) %>% 
  kable()
```

| NodeId |  id | TagRSSI | time\_est           | timeofday |
| :----- | --: | ------: | :------------------ | :-------- |
| 326250 | 142 |   \-103 | 2020-10-18 07:33:00 | 08:33:00  |
| 326250 | 142 |   \-106 | 2020-10-18 07:32:00 | 08:32:00  |
| 326250 | 142 |   \-106 | 2020-10-18 07:36:00 | 08:36:00  |
| 32855D | 141 |    \-96 | 2020-10-18 07:29:00 | 08:29:00  |
| 32855D | 141 |    \-99 | 2020-10-17 16:44:00 | 17:44:00  |
| 32855D | 141 |   \-101 | 2020-10-18 07:28:00 | 08:28:00  |
| 32855D | 141 |   \-102 | 2020-10-17 16:48:00 | 17:48:00  |
| 32855D | 141 |   \-103 | 2020-10-18 06:57:00 | 07:57:00  |
| 32855D | 141 |   \-105 | 2020-10-17 16:41:00 | 17:41:00  |
| 32855D | 141 |   \-106 | 2020-10-17 16:47:00 | 17:47:00  |
| 32855D | 141 |   \-108 | 2020-10-17 07:17:00 | 08:17:00  |
| 32855D | 141 |   \-109 | 2020-10-17 07:21:00 | 08:21:00  |

``` r
View(tag2data)
```
